library(readxl)
> creditcard <- read_excel("Desktop/creditcard.xlsx")
> View(creditcard)                                  
> summary(creditcard)

> install.packages("cli")
> library(cli)

> require(cli)
> str(creditcard)

> install.packages("utf8")


> library(utf8)
> head(creditcard)

> install.packages("ranger")
> library(ranger)
> library(caret)

> install.packages("caret")

> library(caret)
Error: package or namespace load failed for ‘caret’ in loadNamespace(i, c(lib.loc, .libPaths()), versionCheck = vI[[i]]):
  there is no package called ‘stringr’
> install.packages("stringr")

> library(caret)
> library(ggplot2)
> table(creditcard$Class)


> names(creditcard)

> var(creditcard)
Time            V1            V2            V3            V4
Time    2.255124e+09  1.091960e+04 -8.307031e+02 -3.021425e+04 -7.077378e+03
V1      1.091960e+04  3.836489e+00 -2.253101e-16 -1.689616e-15 -7.218172e-16
V2     -8.307031e+02 -2.253101e-16  2.726820e+00  1.303961e-16 -3.771984e-16
V3     -3.021425e+04 -1.689616e-15  1.303961e-16  2.299029e+00 -4.787045e-16
V4     -7.077378e+03 -7.218172e-16 -3.771984e-16 -4.787045e-16  2.004684e+00
V5      1.134407e+04  8.507993e-16  2.550832e-16 -1.258802e-15 -3.598732e-15
V6     -3.986868e+03  3.895731e-16  8.515102e-16  2.883077e-15 -8.012114e-16
V7      4.976739e+03  1.900127e-16 -2.671272e-16  4.309278e-16 -1.300263e-16
V8     -2.095683e+03 -1.273885e-16 -4.854511e-17 -1.332232e-16  1.083173e-15
V9     -4.518322e+02  8.205325e-17 -2.037648e-16  1.727853e-16  9.265088e-16
V10     1.583108e+03  1.135260e-16 -2.414282e-16  3.380916e-16 -1.610091e-16
V11    -1.200595e+04  6.002332e-16  5.796344e-16  1.759076e-16 -4.222793e-16
V12     5.900343e+03  3.559168e-16 -5.362237e-16  3.190468e-16 -2.743682e-16
V13    -3.114775e+03 -9.601409e-17 -6.215213e-17 -5.313409e-17  2.443831e-17
V14    -4.495601e+03  7.271454e-16 -6.025832e-16  9.735714e-16 -1.312253e-16
V15    -7.974101e+03 -1.637843e-16  9.760134e-17 -8.762036e-17  2.389769e-16
V16     4.952977e+02  5.749901e-16  5.888396e-17  7.591775e-16 -5.191050e-17
V17    -2.956329e+03 -3.947619e-17 -8.981351e-16  1.187762e-16 -4.483113e-16
V18     3.599748e+03  2.411476e-16  3.230692e-16  3.975539e-16 -1.795569e-17
V19     1.120106e+03  2.630776e-16  1.617679e-17  4.266403e-16 -3.324387e-16
V20    -1.862195e+03  2.163334e-16  1.042991e-16  8.187716e-17 -2.006228e-16
V21     1.560435e+03 -1.333906e-16  9.751274e-17 -1.773178e-16 -6.162962e-17
V22     4.964595e+03  1.366242e-16  2.038418e-16 -2.484212e-16  2.437121e-16
V23     1.516599e+03  2.150205e-16  1.388903e-16 -7.274261e-17  1.768645e-16
V24    -4.654076e+02 -6.117485e-17 -1.070952e-16  2.321386e-17  1.377298e-16
V25    -5.769855e+03 -2.440594e-16  9.963652e-17  9.057668e-17  4.777431e-16
V26    -9.482254e+02 -1.194110e-16  2.086935e-16 -1.582326e-16 -2.758947e-16
V27    -9.841860e+01  7.635399e-17 -3.510795e-16  3.211759e-16 -6.051631e-17
V28    -1.475443e+02  2.379183e-16 -2.061283e-16  3.667892e-16 -1.621768e-18
Amount -1.258610e+05 -1.115566e+02 -2.194854e+02 -7.997555e+01  3.496456e+01
Class  -2.430072e+01 -8.243501e-03  6.260047e-03 -1.214993e-02  7.846318e-03
V5            V6            V7            V8            V9
Time    1.134407e+04 -3.986868e+03  4.976739e+03 -2.095683e+03 -4.518322e+02
V1      8.507993e-16  3.895731e-16  1.900127e-16 -1.273885e-16  8.205325e-17
V2      2.550832e-16  8.515102e-16 -2.671272e-16 -4.854511e-17 -2.037648e-16
V3     -1.258802e-15  2.883077e-15  4.309278e-16 -1.332232e-16  1.727853e-16
V4     -3.598732e-15 -8.012114e-16 -1.300263e-16  1.083173e-15  9.265088e-16
V5      1.905081e+00  1.152373e-15 -3.435095e-17  8.506334e-16  7.362769e-16
V6      1.152373e-15  1.774946e+00 -8.210251e-17 -5.513444e-16 -1.422764e-16
V7     -3.435095e-17 -8.210251e-17  1.530401e+00 -1.803429e-17  1.030242e-17
V8      8.506334e-16 -5.513444e-16 -1.803429e-17  1.426479e+00  5.556460e-16
V9      7.362769e-16 -1.422764e-16  1.030242e-17  5.556460e-16  1.206992e+00
V10     1.649526e-16  1.983841e-16  4.119568e-16 -1.791019e-18 -3.229084e-16
V11     1.024025e-15  1.196330e-15 -4.613970e-16  1.671703e-16  3.520853e-16
V12     5.400567e-16  3.697094e-16  8.194073e-16  3.729535e-17 -1.372780e-15
V13    -4.019288e-16 -2.103093e-16 -7.660921e-17 -3.514765e-16  1.018626e-15
V14     3.213197e-16  4.314033e-16  3.941509e-17 -3.058326e-16  9.802998e-16
V15     1.454997e-16 -1.368417e-16 -4.173823e-17  1.162995e-16 -8.935848e-16
V16     7.274550e-16 -1.212860e-16  5.338245e-16  1.700332e-16 -4.437251e-16
V17     4.969908e-16  1.411070e-16  5.722059e-16 -3.676099e-16  6.575540e-16
V18     4.783302e-16  6.224364e-17  2.074947e-16 -3.329519e-16  1.339365e-16
V19    -1.339750e-16  8.859237e-17 -7.378106e-17 -3.256574e-16  1.051462e-16
V20    -2.054215e-16  1.192861e-16  2.060103e-16  1.161931e-16 -3.009803e-16
V21    -7.307117e-17 -8.471950e-17  8.940752e-18  2.355761e-17  1.914106e-16
V22     2.281911e-17 -1.115228e-16 -5.925313e-16  2.183488e-17 -1.368112e-16
V23     9.502564e-17  2.898857e-17 -2.040858e-16  1.431084e-16 -6.157844e-17
V24    -8.116750e-16 -8.664065e-16 -5.248256e-18 -1.530572e-16 -1.875003e-16
V25    -7.617631e-17  3.852132e-16  1.201938e-17 -9.763085e-17  1.390854e-16
V26     2.254561e-16 -1.632085e-16 -4.672881e-16  1.207286e-18 -5.067548e-17
V27     2.521865e-16 -7.462670e-17 -9.271735e-17  1.544160e-16 -7.673564e-17
V28    -8.092868e-17  1.900215e-16  3.351999e-17 -2.289830e-16  2.887151e-16
Amount -1.333808e+02  7.197093e+01  1.229368e+02 -3.079299e+01 -1.215825e+01
Class  -5.443715e-03 -2.414579e-03 -9.619937e-03  9.857688e-04 -4.458868e-03
V10           V11           V12           V13           V14
Time    1.583108e+03 -1.200595e+04  5.900343e+03 -3.114775e+03 -4.495601e+03
V1      1.135260e-16  6.002332e-16  3.559168e-16 -9.601409e-17  7.271454e-16
V2     -2.414282e-16  5.796344e-16 -5.362237e-16 -6.215213e-17 -6.025832e-16
V3      3.380916e-16  1.759076e-16  3.190468e-16 -5.313409e-17  9.735714e-16
V4     -1.610091e-16 -4.222793e-16 -2.743682e-16  2.443831e-17 -1.312253e-16
V5      1.649526e-16  1.024025e-15  5.400567e-16 -4.019288e-16  3.213197e-16
V6      1.983841e-16  1.196330e-15  3.697094e-16 -2.103093e-16  4.314033e-16
V7      4.119568e-16 -4.613970e-16  8.194073e-16 -7.660921e-17  3.941509e-17
V8     -1.791019e-18  1.671703e-16  3.729535e-17 -3.514765e-16 -3.058326e-16
V9     -3.229084e-16  3.520853e-16 -1.372780e-15  1.018626e-15  9.802998e-16
V10     1.185594e+00 -3.737432e-16  9.046523e-16 -4.672060e-16  6.498712e-16
V11    -3.737432e-16  1.041855e+00 -6.396571e-16  4.067199e-16 -7.530083e-17
V12     9.046523e-16 -6.396571e-16  9.984034e-01 -2.281869e-14  4.156266e-16
V13    -4.672060e-16  4.067199e-16 -2.281869e-14  9.905708e-01  1.366907e-15
V14     6.498712e-16 -7.530083e-17  4.156266e-16  1.366907e-15  9.189055e-01
V15     4.207638e-16  1.950767e-16 -2.602339e-16 -9.969657e-17 -2.592668e-16
V16     1.684424e-16  1.502834e-16  4.344081e-16  4.149972e-16 -6.830675e-16
V17     6.408210e-16  5.835299e-16 -3.039392e-16  6.557114e-17  9.359919e-16
V18     4.389631e-16  8.425873e-17 -5.073613e-16  2.022768e-16 -1.770281e-16
V19     2.036297e-17 -9.100362e-16  1.482469e-16 -9.741669e-17  1.831406e-16
V20    -1.066823e-15 -1.628537e-16  1.945287e-16  2.838254e-17 -1.611052e-17
V21     8.437978e-16  7.116986e-18  4.223729e-16  1.040365e-16 -1.479176e-16
V22    -2.046427e-16  7.713012e-18 -4.706070e-17 -3.571134e-17  4.277202e-16
V23     1.599479e-16  8.171735e-17  1.770505e-16 -4.245184e-16  1.375314e-16
V24    -5.588807e-17  1.019530e-15  2.654225e-16 -3.928661e-16  1.856586e-17
V25    -1.968290e-16 -3.218968e-16 -6.039739e-18 -4.965960e-17 -1.774361e-17
V26    -1.977573e-16 -5.533003e-17  8.457540e-17 -6.582560e-17 -1.116582e-17
V27    -1.611663e-16 -6.953062e-17 -1.243604e-16 -1.950941e-16  1.649460e-18
V28     8.228600e-17 -1.167724e-16  2.312143e-16  3.563695e-16  7.609465e-16
Amount -2.764342e+01  2.654542e-02 -2.384691e+00  1.317731e+00  8.092317e+00
Class  -9.806768e-03  6.564767e-03 -1.081305e-02 -1.888733e-04 -1.204359e-02
V15           V16           V17           V18           V19
Time   -7.974101e+03  4.952977e+02 -2.956329e+03  3.599748e+03  1.120106e+03
V1     -1.637843e-16  5.749901e-16 -3.947619e-17  2.411476e-16  2.630776e-16
V2      9.760134e-17  5.888396e-17 -8.981351e-16  3.230692e-16  1.617679e-17
V3     -8.762036e-17  7.591775e-16  1.187762e-16  3.975539e-16  4.266403e-16
V4      2.389769e-16 -5.191050e-17 -4.483113e-16 -1.795569e-17 -3.324387e-16
V5      1.454997e-16  7.274550e-16  4.969908e-16  4.783302e-16 -1.339750e-16
V6     -1.368417e-16 -1.212860e-16  1.411070e-16  6.224364e-17  8.859237e-17
V7     -4.173823e-17  5.338245e-16  5.722059e-16  2.074947e-16 -7.378106e-17
V8      1.162995e-16  1.700332e-16 -3.676099e-16 -3.329519e-16 -3.256574e-16
V9     -8.935848e-16 -4.437251e-16  6.575540e-16  1.339365e-16  1.051462e-16
V10     4.207638e-16  1.684424e-16  6.408210e-16  4.389631e-16  2.036297e-17
V11     1.950767e-16  1.502834e-16  5.835299e-16  8.425873e-17 -9.100362e-16
V12    -2.602339e-16  4.344081e-16 -3.039392e-16 -5.073613e-16  1.482469e-16
V13    -9.969657e-17  4.149972e-16  6.557114e-17  2.022768e-16 -9.741669e-17
V14    -2.592668e-16 -6.830675e-16  9.359919e-16 -1.770281e-16  1.831406e-16
V15     8.378034e-01  7.937508e-16 -4.486093e-16  5.229212e-16 -1.072512e-15
V16     7.937508e-16  7.678191e-01  1.247468e-15 -1.991244e-15  7.988373e-16
V17    -4.486093e-16  1.247468e-15  7.213734e-01 -3.733293e-15  2.604792e-16
V18     5.229212e-16 -1.991244e-15 -3.733293e-15  7.025394e-01 -1.824971e-15
V19    -1.072512e-15  7.988373e-16  2.604792e-16 -1.824971e-15  6.626619e-01
V20     1.238228e-16  2.342925e-16 -5.795784e-16 -2.400195e-16  1.804800e-16
V21     3.544872e-17 -2.577051e-16 -5.942191e-16 -7.433619e-16  3.474533e-16
V22    -2.284280e-16  1.617690e-16 -2.002838e-16 -3.267445e-16 -5.949058e-16
V23     5.466529e-17  3.858951e-16  2.319611e-16 -1.550835e-16  3.401284e-16
V24    -2.485255e-16 -1.869590e-16 -8.392844e-17 -9.178814e-17 -4.299444e-17
V25     1.040615e-16 -1.521552e-16  3.495213e-17 -1.091579e-16  3.489695e-16
V26     4.497185e-17 -1.969297e-16  1.041107e-16  1.180560e-16  2.159638e-16
V27    -4.612424e-16  2.868375e-16  2.381167e-16  7.674550e-17 -5.078190e-17
V28    -3.388118e-16  2.032898e-16 -2.339346e-17  2.216262e-16 -3.658229e-16
Amount -6.835769e-01 -8.568450e-01  1.552706e+00  7.473906e+00 -1.143274e+01
Class  -1.605336e-04 -7.151722e-03 -1.151518e-02 -3.880479e-03  1.175833e-03
V20           V21           V22           V23           V24
Time   -1.862195e+03  1.560435e+03  4.964595e+03  1.516599e+03 -4.654076e+02
V1      2.163334e-16 -1.333906e-16  1.366242e-16  2.150205e-16 -6.117485e-17
V2      1.042991e-16  9.751274e-17  2.038418e-16  1.388903e-16 -1.070952e-16
V3      8.187716e-17 -1.773178e-16 -2.484212e-16 -7.274261e-17  2.321386e-17
V4     -2.006228e-16 -6.162962e-17  2.437121e-16  1.768645e-16  1.377298e-16
V5     -2.054215e-16 -7.307117e-17  2.281911e-17  9.502564e-17 -8.116750e-16
V6      1.192861e-16 -8.471950e-17 -1.115228e-16  2.898857e-17 -8.664065e-16
V7      2.060103e-16  8.940752e-18 -5.925313e-16 -2.040858e-16 -5.248256e-18
V8      1.161931e-16  2.355761e-17  2.183488e-17  1.431084e-16 -1.530572e-16
V9     -3.009803e-16  1.914106e-16 -1.368112e-16 -6.157844e-17 -1.875003e-16
V10    -1.066823e-15  8.437978e-16 -2.046427e-16  1.599479e-16 -5.588807e-17
V11    -1.628537e-16  7.116986e-18  7.713012e-18  8.171735e-17  1.019530e-15
V12     1.945287e-16  4.223729e-16 -4.706070e-17  1.770505e-16  2.654225e-16
V13     2.838254e-17  1.040365e-16 -3.571134e-17 -4.245184e-16 -3.928661e-16
V14    -1.611052e-17 -1.479176e-16  4.277202e-16  1.375314e-16  1.856586e-17
V15     1.238228e-16  3.544872e-17 -2.284280e-16  5.466529e-17 -2.485255e-16
V16     2.342925e-16 -2.577051e-16  1.617690e-16  3.858951e-16 -1.869590e-16
V17    -5.795784e-16 -5.942191e-16 -2.002838e-16  2.319611e-16 -8.392844e-17
V18    -2.400195e-16 -7.433619e-16 -3.267445e-16 -1.550835e-16 -9.178814e-17
V19     1.804800e-16  3.474533e-16 -5.949058e-16  3.401284e-16 -4.299444e-17
V20     5.943254e-01 -6.636739e-16  5.363927e-16  5.297562e-17  7.550646e-17
V21    -6.636739e-16  5.395255e-01  1.860237e-15  2.962667e-16  6.191315e-17
V22     5.363927e-16  1.860237e-15  5.266428e-01  1.359120e-16  1.398332e-17
V23     5.297562e-17  2.962667e-16  1.359120e-16  3.899507e-01  2.520325e-17
V24     7.550646e-17  6.191315e-17  1.398332e-17  2.520325e-17  3.668084e-01
V25    -2.013454e-18 -4.053437e-17 -3.660393e-16 -2.371481e-16  3.915871e-16
V26    -1.300935e-16 -1.701521e-16 -1.371700e-17  3.852230e-16  5.443476e-17
V27    -3.076668e-16 -4.146361e-16  4.791260e-17  1.090225e-16 -7.456692e-17
V28    -5.762757e-17  4.910103e-17 -1.288053e-16  2.818403e-16 -5.537844e-17
Amount  6.544507e+01  1.947404e+01 -1.176213e+01 -1.759209e+01  7.795722e-01
Class   6.431787e-04  1.232718e-03  2.426933e-05 -6.963168e-05 -1.816117e-04
V25           V26           V27           V28        Amount
Time   -5.769855e+03 -9.482254e+02 -9.841860e+01 -1.475443e+02 -1.258610e+05
V1     -2.440594e-16 -1.194110e-16  7.635399e-17  2.379183e-16 -1.115566e+02
V2      9.963652e-17  2.086935e-16 -3.510795e-16 -2.061283e-16 -2.194854e+02
V3      9.057668e-17 -1.582326e-16  3.211759e-16  3.667892e-16 -7.997555e+01
V4      4.777431e-16 -2.758947e-16 -6.051631e-17 -1.621768e-18  3.496456e+01
V5     -7.617631e-17  2.254561e-16  2.521865e-16 -8.092868e-17 -1.333808e+02
V6      3.852132e-16 -1.632085e-16 -7.462670e-17  1.900215e-16  7.197093e+01
V7      1.201938e-17 -4.672881e-16 -9.271735e-17  3.351999e-17  1.229368e+02
V8     -9.763085e-17  1.207286e-18  1.544160e-16 -2.289830e-16 -3.079299e+01
V9      1.390854e-16 -5.067548e-17 -7.673564e-17  2.887151e-16 -1.215825e+01
V10    -1.968290e-16 -1.977573e-16 -1.611663e-16  8.228600e-17 -2.764342e+01
V11    -3.218968e-16 -5.533003e-17 -6.953062e-17 -1.167724e-16  2.654542e-02
V12    -6.039739e-18  8.457540e-17 -1.243604e-16  2.312143e-16 -2.384691e+00
V13    -4.965960e-17 -6.582560e-17 -1.950941e-16  3.563695e-16  1.317731e+00
V14    -1.774361e-17 -1.116582e-17  1.649460e-18  7.609465e-16  8.092317e+00
V15     1.040615e-16  4.497185e-17 -4.612424e-16 -3.388118e-16 -6.835769e-01
V16    -1.521552e-16 -1.969297e-16  2.868375e-16  2.032898e-16 -8.568450e-01
V17     3.495213e-17  1.041107e-16  2.381167e-16 -2.339346e-17  1.552706e+00
V18    -1.091579e-16  1.180560e-16  7.674550e-17  2.216262e-16  7.473906e+00
V19     3.489695e-16  2.159638e-16 -5.078190e-17 -3.658229e-16 -1.143274e+01
V20    -2.013454e-18 -1.300935e-16 -3.076668e-16 -5.762757e-17  6.544507e+01
V21    -4.053437e-17 -1.701521e-16 -4.146361e-16  4.910103e-17  1.947404e+01
V22    -3.660393e-16 -1.371700e-17  4.791260e-17 -1.288053e-16 -1.176213e+01
V23    -2.371481e-16  3.852230e-16  1.090225e-16  2.818403e-16 -1.759209e+01
V24     3.915871e-16  5.443476e-17 -7.456692e-17 -5.537844e-17  7.795722e-01
V25     2.717308e-01  6.122151e-16 -1.254354e-16  6.425467e-17 -6.237072e+00
V26     6.122151e-16  2.325429e-01 -5.549724e-17 -4.699416e-17 -3.869364e-01
V27    -1.254354e-16 -5.549724e-17  1.629192e-01  3.999308e-18  2.910121e+00
V28     6.425467e-17 -4.699416e-17  3.999308e-18  1.089550e-01  8.469230e-01
Amount -6.237072e+00 -3.869364e-01  2.910121e+00  8.469230e-01  6.256007e+04
Class   7.160261e-05  8.922171e-05  2.946665e-04  1.307146e-04  5.849581e-02
Class
Time   -2.430072e+01
V1     -8.243501e-03
V2      6.260047e-03
V3     -1.214993e-02
V4      7.846318e-03
V5     -5.443715e-03
V6     -2.414579e-03
V7     -9.619937e-03
V8      9.857688e-04
V9     -4.458868e-03
V10    -9.806768e-03
V11     6.564767e-03
V12    -1.081305e-02
V13    -1.888733e-04
V14    -1.204359e-02
V15    -1.605336e-04
V16    -7.151722e-03
V17    -1.151518e-02
V18    -3.880479e-03
V19     1.175833e-03
V20     6.431787e-04
V21     1.232718e-03
V22     2.426933e-05
V23    -6.963168e-05
V24    -1.816117e-04
V25     7.160261e-05
V26     8.922171e-05
V27     2.946665e-04
V28     1.307146e-04
Amount  5.849581e-02
Class   1.724507e-03
> var(creditcard$Amount)
[1] 62560.07
> sd(creditcard$Amount)
[1] 250.1201
> creditcard$Amount=scale(creditcard$Amount)
> newdata = creditcard[,-c(1)]
> head(newdata)
# A tibble: 6 x 30
V1      V2    V3     V4      V5      V6      V7      V8     V9     V10
<dbl>   <dbl> <dbl>  <dbl>   <dbl>   <dbl>   <dbl>   <dbl>  <dbl>   <dbl>
  1 -1.36  -0.0728 2.54   1.38  -0.338   0.462   0.240   0.0987  0.364  0.0908
2  1.19   0.266  0.166  0.448  0.0600 -0.0824 -0.0788  0.0851 -0.255 -0.167 
3 -1.36  -1.34   1.77   0.380 -0.503   1.80    0.791   0.248  -1.51   0.208 
4 -0.966 -0.185  1.79  -0.863 -0.0103  1.25    0.238   0.377  -1.39  -0.0550
5 -1.16   0.878  1.55   0.403 -0.407   0.0959  0.593  -0.271   0.818  0.753 
6 -0.426  0.961  1.14  -0.168  0.421  -0.0297  0.476   0.260  -0.569 -0.371 
# … with 20 more variables: V11 <dbl>, V12 <dbl>, V13 <dbl>, V14 <dbl>,
#   V15 <dbl>, V16 <dbl>, V17 <dbl>, V18 <dbl>, V19 <dbl>, V20 <dbl>,
#   V21 <dbl>, V22 <dbl>, V23 <dbl>, V24 <dbl>, V25 <dbl>, V26 <dbl>,
#   V27 <dbl>, V28 <dbl>, Amount[,1] <dbl>, Class <dbl>
> install.packages("caTools")
also installing the dependency ‘bitops’

trying URL 'https://cran.rstudio.com/bin/macosx/contrib/4.0/bitops_1.0-6.tgz'
Content type 'application/x-gzip' length 24787 bytes (24 KB)
==================================================
  downloaded 24 KB

trying URL 'https://cran.rstudio.com/bin/macosx/contrib/4.0/caTools_1.18.0.tgz'
Content type 'application/x-gzip' length 244086 bytes (238 KB)
==================================================
  downloaded 238 KB


The downloaded binary packages are in
/var/folders/dx/tsshwh316fz4s85t1_4xydnr0000gn/T//RtmplQWzR8/downloaded_packages
> library(caTools)
> set.seed(123)
> datasample = sample.split(newdata$Class, SplitRatio = 0.8)
> traindata = subset(newdata, datasample==TRUE)
> testdata = subset(newdata, datasample==FALSE)
> dim(traindata)
[1] 227846     30
> dim(testdata)
[1] 56961    30
> logisticmodel = glm(Class~., testdata, family = binomial)
Warning message:
  glm.fit: fitted probabilities numerically 0 or 1 occurred 
> summary(logisticmodel)

Call:
  glm(formula = Class ~ ., family = binomial, data = testdata)

Deviance Residuals: 
  Min       1Q   Median       3Q      Max  
-4.9019  -0.0254  -0.0156  -0.0078   4.0877  

Coefficients:
  Estimate Std. Error z value Pr(>|z|)  
(Intercept) -12.52800   10.30537  -1.216   0.2241  
V1           -0.17299    1.27381  -0.136   0.8920  
V2            1.44512    4.23062   0.342   0.7327  
V3            0.17897    0.24058   0.744   0.4569  
V4            3.13593    7.17768   0.437   0.6622  
V5            1.49014    3.80369   0.392   0.6952  
V6           -0.12428    0.22202  -0.560   0.5756  
V7            1.40903    4.22644   0.333   0.7388  
V8           -0.35254    0.17462  -2.019   0.0435 *
  V9            3.02176    8.67262   0.348   0.7275  
V10          -2.89571    6.62383  -0.437   0.6620  
V11          -0.09769    0.28270  -0.346   0.7297  
V12           1.97992    6.56699   0.301   0.7630  
V13          -0.71674    1.25649  -0.570   0.5684  
V14           0.19316    3.28868   0.059   0.9532  
V15           1.03868    2.89256   0.359   0.7195  
V16          -2.98194    7.11391  -0.419   0.6751  
V17          -1.81809    4.99764  -0.364   0.7160  
V18           2.74772    8.13188   0.338   0.7354  
V19          -1.63246    4.77228  -0.342   0.7323  
V20          -0.69925    1.15114  -0.607   0.5436  
V21          -0.45082    1.99182  -0.226   0.8209  
V22          -1.40395    5.18980  -0.271   0.7868  
V23           0.19026    0.61195   0.311   0.7559  
V24          -0.12889    0.44701  -0.288   0.7731  
V25          -0.57835    1.94988  -0.297   0.7668  
V26           2.65938    9.34957   0.284   0.7761  
V27          -0.45396    0.81502  -0.557   0.5775  
V28          -0.06639    0.35730  -0.186   0.8526  
Amount        0.22576    0.71892   0.314   0.7535  
---
  Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

Null deviance: 1443.40  on 56960  degrees of freedom
Residual deviance:  378.59  on 56931  degrees of freedom
AIC: 438.59

Number of Fisher Scoring iterations: 17

> 
  
  
Hit <Return> to see next plot: 
  Hit <Return> to see next plot: 
  Hit <Return> to see next plot: 
  Hit <Return> to see next plot: 
  Warning messages:
  1: In sqrt(crit * p * (1 - hh)/hh) : NaNs produced
2: In sqrt(crit * p * (1 - hh)/hh) : NaNs produced
> library(pROC)
Type 'citation("pROC")' for a citation.

Attaching package: ‘pROC’

The following objects are masked from ‘package:stats’:
  
  cov, smooth, var

Warning messages:
  1: In doTryCatch(return(expr), name, parentenv, handler) :
  display list redraw incomplete
2: In doTryCatch(return(expr), name, parentenv, handler) :
  invalid graphics state
3: In doTryCatch(return(expr), name, parentenv, handler) :
  invalid graphics state
> install.packages(pROC)
Error in install.packages : object 'pROC' not found
> install.packages("pROC")
Error in install.packages : Updating loaded packages
> install.packages("pROC")
trying URL 'https://cran.rstudio.com/bin/macosx/contrib/4.0/pROC_1.16.2.tgz'
Content type 'application/x-gzip' length 1099935 bytes (1.0 MB)
==================================================
  downloaded 1.0 MB


The downloaded binary packages are in
/var/folders/dx/tsshwh316fz4s85t1_4xydnr0000gn/T//RtmplQWzR8/downloaded_packages
> lr.predict = predict(logisticmodel, traindata, probability = TRUE)
> auc.gbm = roc(testdata$Class)
Error in roc.default(testdata$Class) : No valid data provided.
> auc.gbm = roc(testdata$Class, lr.predict, plot = TRUE, col='blue')
Setting levels: control = 0, case = 1
Error in roc.default(testdata$Class, lr.predict, plot = TRUE, col = "blue") : 
  Response and predictor must be vectors of the same length.
In addition: Warning messages:
  1: In doTryCatch(return(expr), name, parentenv, handler) :
  display list redraw incomplete
2: In doTryCatch(return(expr), name, parentenv, handler) :
  invalid graphics state
3: In doTryCatch(return(expr), name, parentenv, handler) :
  invalid graphics state
> logisticmodel = glm(Class-., traindata, family = binomial)
Error in stats::model.frame(formula = Class - ., data = traindata, drop.unused.levels = TRUE) : 
  object 'Class' not found
> logisticmodel = glm(Class~., traindata, family = binomial)
> summary(logisticmodel)

Call:
  glm(formula = Class ~ ., family = binomial, data = traindata)

Deviance Residuals: 
  Min       1Q   Median       3Q      Max  
-4.6108  -0.0292  -0.0194  -0.0125   4.6021  

Coefficients:
  Estimate Std. Error z value Pr(>|z|)    
(Intercept) -8.651305   0.160212 -53.999  < 2e-16 ***
  V1           0.072540   0.044144   1.643 0.100332    
V2           0.014818   0.059777   0.248 0.804220    
V3           0.026109   0.049776   0.525 0.599906    
V4           0.681286   0.078071   8.726  < 2e-16 ***
  V5           0.087938   0.071553   1.229 0.219079    
V6          -0.148083   0.085192  -1.738 0.082170 .  
V7          -0.117344   0.068940  -1.702 0.088731 .  
V8          -0.146045   0.035667  -4.095 4.23e-05 ***
  V9          -0.339828   0.117595  -2.890 0.003855 ** 
  V10         -0.785462   0.098486  -7.975 1.52e-15 ***
  V11          0.001492   0.085147   0.018 0.986018    
V12          0.087106   0.094869   0.918 0.358532    
V13         -0.343792   0.092381  -3.721 0.000198 ***
  V14         -0.526828   0.067084  -7.853 4.05e-15 ***
  V15         -0.095471   0.094037  -1.015 0.309991    
V16         -0.130225   0.138629  -0.939 0.347537    
V17          0.032463   0.074471   0.436 0.662900    
V18         -0.100964   0.140985  -0.716 0.473909    
V19          0.083711   0.105134   0.796 0.425897    
V20         -0.463946   0.081871  -5.667 1.46e-08 ***
  V21          0.381206   0.065880   5.786 7.19e-09 ***
  V22          0.610874   0.142086   4.299 1.71e-05 ***
  V23         -0.071406   0.058799  -1.214 0.224589    
V24          0.255791   0.170568   1.500 0.133706    
V25         -0.073955   0.142634  -0.519 0.604109    
V26          0.120841   0.202553   0.597 0.550783    
V27         -0.852018   0.118391  -7.197 6.17e-13 ***
  V28         -0.323854   0.090075  -3.595 0.000324 ***
  Amount       0.292477   0.092075   3.177 0.001491 ** 
  ---
  Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

Null deviance: 5799.1  on 227845  degrees of freedom
Residual deviance: 1790.9  on 227816  degrees of freedom
AIC: 1850.9

Number of Fisher Scoring iterations: 12

> install.packages("rpart")
Error in install.packages : Updating loaded packages
> install.packages("rpart")
trying URL 'https://cran.rstudio.com/bin/macosx/contrib/4.0/rpart_4.1-15.tgz'
Content type 'application/x-gzip' length 760273 bytes (742 KB)
==================================================
  downloaded 742 KB


The downloaded binary packages are in
/var/folders/dx/tsshwh316fz4s85t1_4xydnr0000gn/T//RtmplQWzR8/downloaded_packages
> require(rpart)
Loading required package: rpart
> library(rpart)
> library(rpart.plot)
Error in library(rpart.plot) : there is no package called ‘rpart.plot’
> install.packages("rpart.plot")
trying URL 'https://cran.rstudio.com/bin/macosx/contrib/4.0/rpart.plot_3.0.8.tgz'
Content type 'application/x-gzip' length 1056031 bytes (1.0 MB)
==================================================
  downloaded 1.0 MB


The downloaded binary packages are in
/var/folders/dx/tsshwh316fz4s85t1_4xydnr0000gn/T//RtmplQWzR8/downloaded_packages
> library(rpart.plot)
> decisiontreemodel = rpart(Class~.,creditcard, method = 'class')

There were 18 warnings (use warnings() to see them)
> 
  > predictedvalues = predict(decisiontreemodel,creditcard, type='class')
Error in predict(decisiontreemodel, creditcard, type = "class") : 
  object 'decisiontreemodel' not found
> decisiontreemodel = rpart(Class~., creditcard, method="Class")
Error in rpart(Class ~ ., creditcard, method = "Class") : Invalid method
In addition: There were 24 warnings (use warnings() to see them)
> decisiontreemodel = rpart(Class~., creditcard, method="class")
> 
  > 
  > 
  > 
  > decisiontreemodel
n= 284807 

node), split, n, loss, yval, (yprob)
* denotes terminal node

1) root 284807 492 0 (0.9982725144 0.0017274856)  
2) V17>=-2.75394 284364 154 0 (0.9994584406 0.0005415594)  
4) V14>=-8.09768 284328 122 0 (0.9995709181 0.0004290819)  
8) V14>=-4.661454 284081  82 0 (0.9997113499 0.0002886501) *
  9) V14< -4.661454 247  40 0 (0.8380566802 0.1619433198)  
18) V10>=-1.847304 195   4 0 (0.9794871795 0.0205128205) *
  19) V10< -1.847304 52  16 1 (0.3076923077 0.6923076923)  
38) V16>=2.754354 11   0 0 (1.0000000000 0.0000000000) *
  39) V16< 2.754354 41   5 1 (0.1219512195 0.8780487805) *
  5) V14< -8.09768 36   4 1 (0.1111111111 0.8888888889) *
  3) V17< -2.75394 443 105 1 (0.2370203160 0.7629796840)  
6) V12>=-2.18088 33   2 0 (0.9393939394 0.0606060606) *
  7) V12< -2.18088 410  74 1 (0.1804878049 0.8195121951)  
14) V14>=-3.429828 45  19 0 (0.5777777778 0.4222222222)  
28) V8>=-0.3873742 34   9 0 (0.7352941176 0.2647058824) *
  29) V8< -0.3873742 11   1 1 (0.0909090909 0.9090909091) *
  15) V14< -3.429828 365  48 1 (0.1315068493 0.8684931507)  
30) V26< -0.2644702 98  35 1 (0.3571428571 0.6428571429)  
60) V27>=1.077147 34   4 0 (0.8823529412 0.1176470588) *
  61) V27< 1.077147 64   5 1 (0.0781250000 0.9218750000) *
  31) V26>=-0.2644702 267  13 1 (0.0486891386 0.9513108614) *
  > 
  
  > 
  